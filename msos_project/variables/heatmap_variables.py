import numpy
import matplotlib
from matplotlib import pyplot
import scipy
from scipy import signal
from scipy.io.wavfile import read
from scipy.io.wavfile import write
import os
import timeit
import traceback
import msos_project
from msos_project import *
from msos_project.dsp_tools import *
import msos_project.dsp_tools.peakdetection as peakdetection
import msos_project.dsp_tools.peakflatten as peakflatten
import msos_project.dsp_tools.rhythmdetection as rhythmdetection
import msos_project.dsp_tools.find_similar_magnitude_peaks as find_similar_magnitude_peaks
import msos_project.dsp_tools.find_rhythmic_packets as find_rhythmic_packets
from numpy import random
import msos_project.classification_1_rhythm_time_domain_v0_standalone as classifier1
import msos_project.dsp_tools.spectral_centroid_classifier as spectral_centroid_classifier
from scipy import stats
from numpy import polyfit


all_xedges = [[ 142.36737909,  616.57905973, 1090.79074036, 1565.002421  ,
       2039.21410163, 2513.42578227, 2987.6374629 , 3461.84914354,
       3936.06082417, 4410.27250481, 4884.48418544, 5358.69586608,
       5832.90754671, 6307.11922735, 6781.33090798, 7255.54258862,
       7729.75426925, 8203.96594989, 8678.17763052, 9152.38931116,
       9626.60099179], [  364.11241677,   979.91271915,  1595.71302152,  2211.51332389,
        2827.31362627,  3443.11392864,  4058.91423101,  4674.71453338,
        5290.51483576,  5906.31513813,  6522.1154405 ,  7137.91574288,
        7753.71604525,  8369.51634762,  8985.31664999,  9601.11695237,
       10216.91725474, 10832.71755711, 11448.51785949, 12064.31816186,
       12680.11846423], [  112.0304185 ,   691.92753529,  1271.82465209,  1851.72176888,
        2431.61888568,  3011.51600247,  3591.41311926,  4171.31023606,
        4751.20735285,  5331.10446965,  5911.00158644,  6490.89870323,
        7070.79582003,  7650.69293682,  8230.59005362,  8810.48717041,
        9390.3842872 ,  9970.281404  , 10550.17852079, 11130.07563759,
       11709.97275438], [ 160.81828297,  621.07296479, 1081.32764661, 1541.58232844,
       2001.83701026, 2462.09169208, 2922.3463739 , 3382.60105572,
       3842.85573755, 4303.11041937, 4763.36510119, 5223.61978301,
       5683.87446484, 6144.12914666, 6604.38382848, 7064.6385103 ,
       7524.89319213, 7985.14787395, 8445.40255577, 8905.65723759,
       9365.91191942], [   69.63554528,   582.05606924,  1094.4765932 ,  1606.89711717,
        2119.31764113,  2631.7381651 ,  3144.15868906,  3656.57921302,
        4168.99973699,  4681.42026095,  5193.84078491,  5706.26130888,
        6218.68183284,  6731.1023568 ,  7243.52288077,  7755.94340473,
        8268.36392869,  8780.78445266,  9293.20497662,  9805.62550058,
       10318.04602455]]


all_yedges = [[  53.3532592 ,  294.88848306,  536.42370691,  777.95893077,
       1019.49415463, 1261.02937848, 1502.56460234, 1744.09982619,
       1985.63505005, 2227.1702739 , 2468.70549776, 2710.24072161,
       2951.77594547, 3193.31116932, 3434.84639318, 3676.38161703,
       3917.91684089, 4159.45206475, 4400.9872886 , 4642.52251246,
       4884.05773631], [61.13887933,  270.61183714,  480.08479494,  689.55775275,
        899.03071055, 1108.50366836, 1317.97662616, 1527.44958397,
       1736.92254177, 1946.39549958, 2155.86845738, 2365.34141519,
       2574.81437299, 2784.2873308 , 2993.7602886 , 3203.23324641,
       3412.70620421, 3622.17916202, 3831.65211982, 4041.12507763,
       4250.59803543] , [41.4458067 ,  345.93836221,  650.43091773,  954.92347324,
       1259.41602876, 1563.90858427, 1868.40113979, 2172.8936953 ,
       2477.38625081, 2781.87880633, 3086.37136184, 3390.86391736,
       3695.35647287, 3999.84902839, 4304.3415839 , 4608.83413942,
       4913.32669493, 5217.81925044, 5522.31180596, 5826.80436147,
       6131.29691699] , [76.26322407,  356.65341042,  637.04359677,  917.43378313,
       1197.82396948, 1478.21415583, 1758.60434219, 2038.99452854,
       2319.38471489, 2599.77490125, 2880.1650876 , 3160.55527395,
       3440.94546031, 3721.33564666, 4001.72583301, 4282.11601937,
       4562.50620572, 4842.89639207, 5123.28657843, 5403.67676478,
       5684.06695113], [152.72566328,  422.9090928 ,  693.09252232,  963.27595185,
       1233.45938137, 1503.64281089, 1773.82624041, 2044.00966994,
       2314.19309946, 2584.37652898, 2854.55995851, 3124.74338803,
       3394.92681755, 3665.11024707, 3935.2936766 , 4205.47710612,
       4475.66053564, 4745.84396516, 5016.02739469, 5286.21082421,
       5556.39425373]]



all_heatmaps = [[[27.,  6.,  9.,  4.,  1.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [16.,  6., 10., 10.,  3.,  3.,  2.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [14., 15.,  9.,  8.,  4.,  0.,  2.,  2.,  1.,  0.,  1.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 6.,  8., 13., 10.,  7.,  6.,  1.,  0.,  1.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 2.,  6.,  7.,  3.,  2.,  3.,  0.,  3.,  0.,  0.,  0.,  0.,  1.,
         0.,  0.,  0.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  2.,  0.,  1.,  2.,  2.,  0.,  2.,  0.,  2.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  1.,  0.],
       [ 0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,  1.,  1.,
         0.,  0.,  1.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  2.,  2.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  2.,  1.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  3.,  1.,  1.,  0.,  0.,  1.,  0.,  0.,  1.,  0.,
         0.,  0.,  0.,  0.,  1.,  0.,  1.],
       [ 0.,  0.,  1.,  0.,  2.,  1.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  1.,  0.],
       [ 0.,  0.,  4.,  0.,  1.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  0.,  1.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,  1.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  1.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  1.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  0.,  0.,  0.,  0.,  1.,  0.,  2.,  2.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  2.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  1.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.]], [[13.,  2.,  1.,  0.,  1.,  2.,  2.,  1.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [12.,  5.,  7.,  4.,  0.,  6.,  4.,  2.,  1.,  4.,  0.,  0.,  1.,
         0.,  1.,  0.,  0.,  0.,  0.,  0.],
       [ 6.,  7.,  9.,  3.,  3.,  1.,  3.,  4.,  0.,  0.,  0.,  1.,  0.,
         1.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 7.,  8.,  9.,  7.,  4.,  4.,  1.,  4.,  1.,  0.,  1.,  0.,  0.,
         0.,  1.,  0.,  0.,  0.,  0.,  0.],
       [ 7.,  9.,  7., 10.,  2.,  2.,  1.,  0.,  0.,  0.,  0.,  0.,  1.,
         0.,  0.,  0.,  0.,  1.,  0.,  0.],
       [ 4.,  4.,  5.,  3.,  3.,  2.,  2.,  1.,  0.,  1.,  1.,  1.,  0.,
         0.,  0.,  2.,  0.,  0.,  0.,  0.],
       [ 1.,  3.,  3.,  3.,  1.,  3.,  2.,  2.,  3.,  1.,  0.,  0.,  1.,
         0.,  1.,  0.,  0.,  0.,  0.,  0.],
       [ 2.,  3.,  0.,  3.,  2.,  1.,  0.,  3.,  0.,  1.,  0.,  0.,  0.,
         0.,  0.,  0.,  1.,  0.,  0.,  1.],
       [ 0.,  0.,  2.,  3.,  2.,  1.,  3.,  1.,  0.,  1.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 2.,  3.,  1.,  0.,  0.,  0.,  2.,  1.,  2.,  0.,  0.,  1.,  0.,
         0.,  1.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.]], [[ 5.,  0.,  1.,  3.,  2.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [21.,  2.,  2.,  3.,  4.,  0.,  4.,  2.,  0.,  1.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [22., 12.,  2.,  2.,  1.,  1.,  0.,  0.,  3.,  6.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [17., 12.,  5.,  0.,  1.,  1.,  2.,  1.,  0.,  2.,  3.,  0.,  1.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 9.,  5.,  5.,  6.,  3.,  1.,  1.,  2.,  2.,  2.,  0.,  1.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 5., 11.,  9.,  5.,  3.,  0.,  0.,  0.,  1.,  0.,  1.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 3.,  7.,  9.,  6.,  0.,  2.,  0.,  0.,  1.,  0.,  1.,  1.,  0.,
         1.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 5.,  5.,  4.,  7.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 2.,  0.,  3.,  0.,  1.,  1.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  1.,  3.,  3.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  2.,  1.,  1.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  1.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  1.]], [[ 1.,  1.,  0.,  1.,  2.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  2.,  1.,  5.,  4.,  7.,  5.,  1.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  2.,  0.,  3.,  6.,  3.,  2.,  2.,  1.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 2.,  6.,  2.,  2.,  7.,  1.,  2.,  0.,  0.,  2.,  1.,  1.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 2.,  7.,  5.,  1.,  3.,  0.,  1.,  5.,  1.,  2.,  2.,  2.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 7.,  9.,  9.,  2.,  2.,  1.,  0.,  0.,  0.,  2.,  0.,  1.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  6., 16.,  5.,  5.,  2.,  2.,  1.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  3.,  7., 11.,  3.,  3.,  0.,  1.,  0.,  1.,  0.,  1.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  3.,  6.,  6.,  4.,  4.,  3.,  1.,  1.,  1.,  0.,  1.,  0.,
         0.,  1.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  3.,  4.,  2.,  0.,  4.,  2.,  2.,  0.,  0.,  0.,  1.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  2.,  1.,  0.,  4.,  2.,  0.,  0.,  1.,  1.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  3.,  2.,  3.,  0.,  0.,  0.,  1.,  1.,  1.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  2.,  1.,  3.,  3.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  2.,  1.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  1.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.]], [[ 4.,  8., 10.,  9.,  4.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 2.,  1.,  2.,  6., 11., 14.,  7.,  0.,  0.,  0.,  0.,  0.,  1.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 2.,  2.,  1.,  3.,  5.,  3.,  5., 13.,  5.,  8.,  4.,  2.,  1.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  2.,  3.,  3.,  1.,  5.,  5.,  1.,  6.,  4.,  3.,  1.,
         1.,  1.,  2.,  0.,  2.,  0.,  0.],
       [ 1.,  1.,  1.,  2.,  1.,  2.,  2.,  1.,  3.,  2.,  4.,  3.,  2.,
         0.,  1.,  0.,  1.,  0.,  1.,  0.],
       [ 0.,  2.,  1.,  2.,  2.,  2.,  1.,  5.,  1.,  0.,  2.,  1.,  2.,
         2.,  0.,  1.,  1.,  0.,  1.,  1.],
       [ 0.,  3.,  1.,  0.,  2.,  0.,  1.,  1.,  1.,  0.,  1.,  2.,  0.,
         0.,  0.,  0.,  0.,  1.,  0.,  0.],
       [ 0.,  3.,  1.,  2.,  1.,  1.,  2.,  2.,  0.,  1.,  0.,  0.,  0.,
         0.,  1.,  0.,  0.,  1.,  0.,  0.],
       [ 0.,  1.,  1.,  1.,  0.,  1.,  0.,  0.,  0.,  1.,  0.,  0.,  1.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  1.,  1.,  0.,  2.,  2.,  0.,  0.,  1.,  1.,  0.,  1.,
         1.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  0.,  2.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,  1.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,
         0.,  1.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  3.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  1.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,
         1.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  1.,  1.],
       [ 0.,  0.,  0.,  1.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  1.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.]]]


def max_value(input_list):

    max_values = []
    for x in range(len(input_list)):
        current_category = input_list[x]
        max_values.append( max(current_category))
        pass
    max_value = max(max_values)
    return(max_value)

"""
Heatmap for each category is divided by the largest heatmap value of the category,
which produces a 2d space of values between 0 and 1, which will be our weights for categorization
"""

for category in all_heatmaps:

    max_val_of_category = max_value(category)
    #print("max_val_of_category = ", max_val_of_category)

    for row_list in category:

        for x in range(len(row_list)):
            current_val = row_list[x]  # find current value
            row_list[x] = current_val / max_val_of_category  # replace with value between 0 and 1

            pass

        pass

#print("All heatmap values = ", all_heatmaps)



